{% extends "labster_admin/base.html" %}
{% load url from future %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-lg-12">
      <h2>{{ lab.name }}</h2>
      <hr>
      {% if messages %}
      <div class="alert alert-success" role="alert">
        {% for message in messages %}
        <div>{{ message|safe }}</div>
        {% endfor %}
      </div>
      {% endif %}
      <form method="post" class="form-horizontal">
        {% csrf_token %}
        {{ formset.management_form }}
        <div class="form-group">
          <div class="col-sm-5"><label>Keyword</label></div>
          <div class="col-sm-1"><label>Rank</label></div>
          <div class="col-sm-1"><label>Delete</label></div>
        </div>
        <div class="input-container">
          {% for form in formset %}
          <div class="form-group">
            <div class="col-sm-5">
              {{ form.id }}
              {{ form.display_name }}
            </div>
            <div class="col-sm-1">
              {{ form.display_rank }}
            </div>
            <div class="col-sm-1">
              {{ form.DELETE }}
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="form-group">
          <div class="col-sm-5">
            <a href="" id="add-form" class="btn btn-default">Add Row</a>
          </div>
        </div>
        <button class="btn btn-primary" type="submit">save</button>
      </form>
    </div>
  </div>
</div>

<script id="empty-form" type="text/template">
  <div class="form-group">
    <div class="col-sm-5">
      {{ formset.empty_form.id }}
      {{ formset.empty_form.display_name }}
    </div>
    <div class="col-sm-1">
      {{ formset.empty_form.display_rank }}
    </div>
    <div class="col-sm-1">
      {{ formset.empty_form.DELETE }}
    </div>
  </div>
</script>
{% endblock %}

{% block extra_js %}
<script>
$(function() {
  var totalForm = $('#id_labkeyword_set-TOTAL_FORMS'),
    emptyForm = $('#empty-form'),
    addForm = $('#add-form'),
    inputContainer = $('.input-container');

  addForm.click(function(ev) {
    ev.preventDefault();
    var html = emptyForm.html(),
      nextIndex = parseInt(totalForm.val());

    html = html.replace(/__prefix__/g, nextIndex);
    inputContainer.append(html);
    totalForm.val(nextIndex + 1);
  });
});
</script>
{% endblock %}
